### 游览器缓存

> 游览器分为协商缓存和强缓存。

- 一些 `http header` 判断是否命中强缓存，如果命中，直接从本地获取资源而不会将请求发送到服务器上。

- 当强缓存没有命中时，客户端会发送请求到服务器，服务器通过另一些`http header`来判断是否命中协商缓存，成为`http再验证`。如果命中，服务器会将请求返回，但是依然不返回资源，而是告诉用户从本地缓存中获取，客户端收到后就会从缓存中获取资源。

- 强缓存和协商缓存的相同点是，都前端都对其发送了请求，且服务器都不会返回资源。不同点是强缓存不会把请求发送到服务器但是协商缓存会。

- 当协商缓存也没命中，服务器就会将资源返回给客户端。

  

**强缓存**

- `Expires`（该字段是 `http1.0` 时的规范，值为一个绝对时间的 `GMT` 格式的时间字符串，代表缓存资源的过期时间）
- `Cache-Control:max-age`（该字段是 `http1.1`的规范，强缓存利用其 `max-age` 值来判断缓存资源的最大生命周期，它的值单位为秒）

**协商缓存**

- `Last-Modified`（值为资源最后更新时间，随服务器response返回，即使文件改回去，日期也会变化）

- `If-Modified-Since`（通过比较两个时间来判断资源在两次请求期间是否有过修改，如果没有修改，则命中协商缓存）

- `ETag`（表示资源内容的唯一标识，随服务器`response`返回，仅根据文件内容是否变化判断）

- `If-None-Match`（服务器通过比较请求头部的`If-None-Match`与当前资源的`ETag`是否一致来判断资源是否在两次请求之间有过修改，如果没有修改，则命中协商缓存）

  

### 总结

强缓存是前端自己和自己的 behavior，发送请求时看文件的`Expires`和`Cache-Control`来判断是否过期，没过期直接使用。

协商缓存则是游览器发现文件过期了，需要和服务器通讯，让服务器也判断是否过期，没过期就还是用游览器缓存，过期了就正常请求返回新的文件。

